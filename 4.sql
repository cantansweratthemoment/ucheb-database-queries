select "Н_ГРУППЫ_ПЛАНОВ"."ПЛАН_ИД"
from "Н_ГРУППЫ_ПЛАНОВ"
         join "Н_УЧЕНИКИ" on "Н_ГРУППЫ_ПЛАНОВ"."ГРУППА" = "Н_УЧЕНИКИ"."ГРУППА"
where (select COUNT(distinct "ГРУППА")
       from "Н_УЧЕНИКИ"
       where "ВИД_ОБУЧ_ИД" = 1) = 2;
